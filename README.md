# ranger-policy-render
A lightweight CLI utility to transform complex Apache Ranger policy JSON exports into human-readable tables.

# Example run

Input: [kyubbi's policy JSON used as a test resource](https://raw.githubusercontent.com/apache/kyuubi/refs/heads/master/extensions/spark/kyuubi-spark-authz/src/test/resources/sparkSql_hive_jenkins.json)

```
$ ranger-policy-render extensions/spark/kyuubi-spark-authz/src/test/resources/sparkSql_hive_jenkins.json
Access Policies:
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|   ID | Name                          | URL   | DB                                                 | Table         | Column   | UDF          | Users                        | Accesses    |
+======+===============================+=======+====================================================+===============+==========+==============+==============================+=============+
|    0 | all - url                     | *     |                                                    |               |          |              | admin                        | all         |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    1 | all - database, table, column |       | *                                                  | *             | *        |              | admin                        | all         |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    2 | all - database, udf           |       | *                                                  |               |          | *            | admin                        | all         |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    3 | all - database, udf           |       | default, spark_catalog, iceberg_ns, ns1, paimon_ns | *             | *        |              | bob, perm_view_user, {OWNER} | all         |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    3 | all - database, udf           |       | default, spark_catalog, iceberg_ns, ns1, paimon_ns | *             | *        |              | bob, perm_view_user, {OWNER} | all         |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    4 | default_kent                  |       | default, spark_catalog                             | src           | key      |              | kent                         | all         |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    4 | default_kent                  |       | default, spark_catalog                             | src           | key      |              | kent                         | all         |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    5 | default_bob_use               |       | default_bob, spark_catalog                         | table_use*    | *        |              | bob                          | update      |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    6 | default_bob_select            |       | default_bob, spark_catalog                         | table_select* | *        |              | bob                          | select, use |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    7 | someone_access_perm_view      |       | default                                            | perm_view     | *        |              | user_perm_view_only          | select      |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    8 | someone_access_table2         |       | default                                            | table2        | *        |              | user_table2_only             | select      |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|    9 | someone_access_table1_in_ns   |       | iceberg_ns, hudi_ns, paimon_ns, delta_ns           | table1        | *        |              | user_table1_only_for_ns      | select      |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|   10 | defaultdb_udf                 |       | default                                            |               |          | kyuubi_func* | bob                          | all         |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+
|   10 | defaultdb_udf                 |       | default                                            |               |          | kyuubi_func* | bob                          | all         |
+------+-------------------------------+-------+----------------------------------------------------+---------------+----------+--------------+------------------------------+-------------+

Row Filter Policies:
+------+----------------------------+-------+---------+-----------+----------+-------+---------------------+------------+-------------------------+
|   ID | Name                       | URL   | DB      | Table     | Column   | UDF   | Users               | Accesses   | Row Filter Expression   |
+======+============================+=======+=========+===========+==========+=======+=====================+============+=========================+
|   11 | src_key_less_than_20       |       | default | src       |          |       | bob, perm_view_user | select     | key<20                  |
+------+----------------------------+-------+---------+-----------+----------+-------+---------------------+------------+-------------------------+
|   12 | perm_view_key_less_than_20 |       | default | perm_view |          |       | perm_view_user      | select     | key<20                  |
+------+----------------------------+-------+---------+-----------+----------+-------+---------------------+------------+-------------------------+

Data Mask Policies:
+------+--------------------------+-------+-----------------------------------------+-----------+----------+-------+----------------+------------+------------------------+
|   ID | Name                     | URL   | DB                                      | Table     | Column   | UDF   | Users          | Accesses   | Data Mask Expression   |
+======+==========================+=======+=========================================+===========+==========+=======+================+============+========================+
|   13 | src_value_hash_perm_view |       | default, spark_catalog                  | src       | value1   |       | bob            | select     | MASK_HASH              |
+------+--------------------------+-------+-----------------------------------------+-----------+----------+-------+----------------+------------+------------------------+
|   14 | src_value_hash           |       | default, spark_catalog                  | perm_view | value1   |       | perm_view_user | select     | MASK_HASH              |
+------+--------------------------+-------+-----------------------------------------+-----------+----------+-------+----------------+------------+------------------------+
|   15 | src_value2_nullify       |       | default, spark_catalog, iceberg_ns, ns1 | src       | value2   |       | bob            | select     | MASK                   |
+------+--------------------------+-------+-----------------------------------------+-----------+----------+-------+----------------+------------+------------------------+
|   16 | src_value3_sf4           |       | default, spark_catalog                  | src       | value3   |       | bob            | select     | MASK_SHOW_FIRST_4      |
+------+--------------------------+-------+-----------------------------------------+-----------+----------+-------+----------------+------------+------------------------+
|   17 | src_value4_sf4           |       | default, spark_catalog                  | src       | value4   |       | bob            | select     | MASK_DATE_SHOW_YEAR    |
+------+--------------------------+-------+-----------------------------------------+-----------+----------+-------+----------------+------------+------------------------+
|   18 | src_value5_sf4           |       | default, spark_catalog                  | src       | value5   |       | bob            | select     | MASK_SHOW_LAST_4       |
+------+--------------------------+-------+-----------------------------------------+-----------+----------+-------+----------------+------------+------------------------+
```

# Install

```
$ pip install git+https://github.com/attilapiros/ranger-policy-render
```
